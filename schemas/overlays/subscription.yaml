overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Subscription Terraform overlay
  version: 0.0.1
actions:

  # Entity management
  - target: $.paths["/organizations/{orgId}/environments/{envId}/apis/{apiHrid}/subscriptions"].put
    update:
      x-speakeasy-entity-operation: Subscription#create,update
  - target: $.paths["/organizations/{orgId}/environments/{envId}/apis/{apiHrid}/subscriptions/{hrid}"].get
    update:
      x-speakeasy-entity-operation: Subscription#read
  - target: $.paths["/organizations/{orgId}/environments/{envId}/apis/{apiHrid}/subscriptions/{hrid}"].delete
    update:
      x-speakeasy-entity-operation: Subscription#delete
  - target: $.components.schemas.SubscriptionSpec
    update:
      x-speakeasy-entity: Subscription

  # Diff removal API State
  - target: $.components.schemas.SubscriptionState.allOf[?@.properties.id].properties.id
    description: Not returned by the API, so prevent null values during refresh
    update:
      x-speakeasy-param-computed: true
      x-speakeasy-param-suppress-computed-diff: true
  - target: $.components.schemas.SubscriptionState.allOf[?@.properties.crossId].properties.crossId
    description: Not returned by the API, so prevent null values during refresh
    update:
      x-speakeasy-param-computed: true
      x-speakeasy-param-suppress-computed-diff: true
  - target: $.components.schemas.SubscriptionState.allOf[?@.properties.startingAt].properties.startingAt
    description: Not returned by the API, so prevent null values during refresh
    update:
      x-speakeasy-param-computed: true
      x-speakeasy-param-suppress-computed-diff: true
  - target: $.components.schemas.SubscriptionSpec.properties.endingAt
    description: Using RFC3339 to make sure dates semantics equal
    update:
      x-speakeasy-terraform-custom-type:
        imports:
          - "github.com/gravitee-io/terraform-provider-apim/internal/provider/customtypes"
        schemaType: customtypes.RFC3339Type{}
        valueType: customtypes.RFC3339